<!DOCTYPE html>
<html>
<head>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://kit.fontawesome.com/5104cee2db.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Baloo+2|Poppins&display=swap" rel="stylesheet">
</head>
<style>

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background-color: #AC0000;
  height: 100%;
  overflow: hidden;
}

.dots{
  margin-left: auto;
  margin-right: auto;
}

/* #title{
  text-align: center;
  font-family: 'Poppins', sans-serif;
  transition: 2.5s;
  transition-property: color;
  line-height: 110px;
  font-size: 120px;
  color: #FFFFFC;
} */

#title{
  text-align: center;
  font-family: 'Poppins', sans-serif;
  transition: 2.5s;
  transition-property: color;
}

#title:not(.level){
  line-height: 110px;
  font-size: 120px;
  color: #FFFFFC;
}

#title.level{
  line-height: 95px;
  font-size: 110px;
  color: black;
  margin-block-start: 0.5em;
  margin-block-end: 0.5em;
}



.dot {
  height: 55px;
  width: 55px;
  background-color: #FFFFFC;
  border-radius: 50%;
  display: inline-block;
  /* margin-left: 12px;
  margin-right: 12px; */

  text-align: center;
  font-family: 'Poppins', sans-serif;
  /* color: #AC0000; */
  font-size: 65px;
  line-height: 79px;
  font-weight: bold;
}

#menu .dot{
  color: #AC0000;
  margin-left: 12px;
  margin-right: 12px;
  margin-bottom: 15px;
}

#level-1 .dot{
  color: #223868;
  margin-left: 40px;
  margin-right: 40px;
}

#level-2 .dot{
  color: #223868;
  margin-left: 40px;
  margin-right: 40px;
}

#level-3 .dot{
  color: #223868;
  margin-left: 40px;
  margin-right: 40px;
}

#level-4 .dot{
  color: #223868;
  margin-left: 40px;
  margin-right: 40px;
}

#level-5 .dot{
  color: #223868;
  margin-left: 40px;
  margin-right: 40px;
}

@keyframes change {
  0%{
    background-position: 0 50%;
  }
  50%{
    background-position: 100% 50%;
  }
  100%{
    background-position: 0% 50%;
  }
}

.dot:hover {
  cursor: pointer;
  transition-timing-function: ease-in-out;
  transition: 0.25s;
  -webkit-transform: translateY(-2px);
	transform: translateY(-2px);
}

#my-canvas{
  position:absolute;
  top:0;
  left: 0;
  z-index: -1;
}

#menu{
  transition: 1.5s;
  transition-timing-function: ease-in;
}

.arrow{
  position: relative;
  width: 60px;
  height:60px;
  color: white;
  /* background-color: purple; */
  cursor: pointer;
  font-size: 60px;
  outline: none;
  border: none;
  display: block;
  transition: 1s;
  transition-property: transform;
}

.arrow-container{
  display: flex;
  margin-bottom:50px;
  margin-left: auto;
  margin-right:auto;
}


#level-1{
  display: none;
  background-color: #223868;
  overflow: hidden;
  text-align: center;
  /* transition: 1.5s; */
  /* background-color: #FFFFFC; */
}

#level-2{
  display: none;
  background-color: #223868;
  overflow: hidden;
  text-align: center;
  /* transition: 1.5s; */
  /* background-color: #FFFFFC; */
}

#level-3{
  display: none;
  background-color: #223868;
  overflow: hidden;
  text-align: center;
  /* transition: 1.5s; */
  /* background-color: #FFFFFC; */
}

#level-4{
  display: none;
  background-color: #223868;
  overflow: hidden;
  text-align: center;
  /* transition: 1.5s; */
  /* background-color: #FFFFFC; */
}

#level-5{
  display: none;
  background-color: #223868;
  overflow: hidden;
  text-align: center;
  /* transition: 1.5s; */
  /* background-color: #FFFFFC; */
}

.color-bar{
  position: absolute;
  bottom: 0px;
  width: 100%;
  height: 12px;
  background-color: green;
  display: flex;
}

.color-bar-item{
  width: 33.33%;
  height: 100%;
}

.animateUp {
  animation: wobbleUp 1s;
  animation-iteration-count: 1;
  -webkit-animation: wobbleUp 1s;
  -webkit-animation-iteration-count: 1;
}

.animateDown {
  animation: wobbleDown 1s;
  animation-iteration-count: 1;
  -webkit-animation: wobbleDown 1s;
  -webkit-animation-iteration-count: 1;
}

@keyframes wobbleUp {
  0% {transform: rotate(0deg);}
  10%{transform: rotate(4.5deg);}
  20%{transform: rotate(0deg);}
  30%{transform: rotate(-3.5deg);}
  40%{transform: rotate(0deg);}
  50%{transform: rotate(3deg);}
  60%{transform: rotate(0deg);}
  70%{transform: rotate(-2.5deg);}
  80%{transform: rotate(0deg);}
  90%{transform: rotate(2deg);}
  100% {transform: rotate(0deg);}
}

@-webkit-keyframes wobbleUp {
  0% {transform: rotate(0deg);}
  10%{transform: rotate(4.5deg);}
  20%{transform: rotate(0deg);}
  30%{transform: rotate(-3.5deg);}
  40%{transform: rotate(0deg);}
  50%{transform: rotate(3deg);}
  60%{transform: rotate(0deg);}
  70%{transform: rotate(-2.5deg);}
  80%{transform: rotate(0deg);}
  90%{transform: rotate(2deg);}
  100% {transform: rotate(0deg;)}
}

@keyframes wobbleDown {
  0% {transform: rotate(180deg);}
  10%{transform: rotate(184.5deg);}
  20%{transform: rotate(180deg);}
  30%{transform: rotate(176.5deg);}
  40%{transform: rotate(180deg);}
  50%{transform: rotate(183deg);}
  60%{transform: rotate(180deg);}
  70%{transform: rotate(177.5deg);}
  80%{transform: rotate(180deg);}
  90%{transform: rotate(182deg);}
  100% {transform: rotate(180deg);}
}

@-webkit-keyframes wobbleDown {
  0% {transform: rotate(180deg);}
  10%{transform: rotate(184.5deg);}
  20%{transform: rotate(180deg);}
  30%{transform: rotate(176.5deg);}
  40%{transform: rotate(180deg);}
  50%{transform: rotate(183deg);}
  60%{transform: rotate(180deg);}
  70%{transform: rotate(177.5deg);}
  80%{transform: rotate(180deg);}
  90%{transform: rotate(182deg);}
  100% {transform: rotate(180deg);}
}

</style>

<body>
  <canvas id="my-canvas"></canvas>
  <h1 id = "title">The Box of <br> Algod√≥n</h1>

  <div id = "menu">
    <table class = "dots">
      <tr>
        <th><span class="dot" id = "level-1-button">1</span></th>
        <th><span class="dot" id = "level-2-button">2</span></th>
        <th><span class="dot" id = "level-3-button">3</span></th>
        <th><span class="dot" id = "level-4-button">4</span></th>
      </tr>
      <tr style = "margin-top: 10px;">
        <th><span class="dot" id = "level-5-button">5</span></th>
        <th><span class="dot" id = "level-6-button">6</span></th>
        <th><span class="dot" id = "level-7-button">7</span></th>
        <th><span class="dot" id = "level-8-button">8</span></th>
      </tr>
    </table>
  </div>

  <div id = "level-1">
    <div class = "arrow-container" style="margin-top: 60px;">
      <i id= "arrow-1-1" class="fas fa-arrow-up arrow" style="margin-left:auto; margin-right:auto; transform: rotate(0deg);"></i>
    </div>
    <div class = "arrow-container">
      <i id= "arrow-1-2" class="fas fa-arrow-up arrow" style="margin-left:auto; margin-right: 40px; transform: rotate(180deg);"></i>
      <i id= "arrow-1-3" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right: auto; transform: rotate(180deg);"></i>
    </div>
    <table class = "dots">
      <tr>
        <th><span class="dot" id = "1-a">a</span></th>
        <th><span class="dot" id = "1-b">b</span></th>
      </tr>
    </table>
  </div>

  <div id = "level-2">
    <div class = "arrow-container" style="margin-top: 60px;">
      <i id= "arrow-2-1" class="fas fa-arrow-up arrow" style="margin-left:auto; margin-right:40px; transform: rotate(180deg);"></i>
      <i id= "arrow-2-2" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right:auto; transform: rotate(0deg);"></i>
    </div>
    <div class = "arrow-container">
      <i id= "arrow-2-3" class="fas fa-arrow-up arrow" style="margin-left:auto; margin-right: 40px; transform: rotate(0deg);"></i>
      <i id= "arrow-2-4" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right: auto; transform: rotate(180deg);"></i>
    </div>
    <table class = "dots">
      <tr>
        <th><span class="dot" id = "2-a">a</span></th>
        <th><span class="dot" id = "2-b">b</span></th>
        <th><span class="dot" id = "2-c">c</span></th>
      </tr>
    </table>
  </div>

  <div id = "level-3">
    <div class = "arrow-container" style="margin-top: 60px;">
      <i id= "arrow-3-1" class="fas fa-arrow-up arrow" style="margin-left:auto; margin-right:40px; transform: rotate(180deg);"></i>
      <i id= "arrow-3-2" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right:40px; transform: rotate(0deg);"></i>
      <i id= "arrow-3-3" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right:auto; transform: rotate(180deg);"></i>
    </div>
    <div class = "arrow-container">
      <i id= "arrow-3-4" class="fas fa-arrow-up arrow" style="margin-left:auto; margin-right: 40px; transform: rotate(180deg);"></i>
      <i id= "arrow-3-5" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right: 40px; transform: rotate(0deg);"></i>
      <i id= "arrow-3-6" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right: auto; transform: rotate(180deg);"></i>
    </div>
    <table class = "dots">
      <tr>
        <th><span class="dot" id = "3-a">a</span></th>
        <th><span class="dot" id = "3-b">b</span></th>
        <th><span class="dot" id = "3-c">c</span></th>
      </tr>
    </table>
  </div>

  <div id = "level-4">
    <div class = "arrow-container" style="margin-top: 60px;">
      <i id= "arrow-4-1" class="fas fa-arrow-up arrow" style="margin-left:auto; margin-right:40px; transform: rotate(180deg);"></i>
      <i id= "arrow-4-2" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right:40px; transform: rotate(0deg);"></i>
      <i id= "arrow-4-3" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right:auto; transform: rotate(180deg);"></i>
    </div>
    <div class = "arrow-container">
      <i id= "arrow-4-4" class="fas fa-arrow-up arrow" style="margin-left:auto; margin-right: 40px; transform: rotate(180deg);"></i>
      <i id= "arrow-4-5" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right: 40px; transform: rotate(0deg);"></i>
      <i id= "arrow-4-6" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right: auto; transform: rotate(180deg);"></i>
    </div>
    <table class = "dots">
      <tr>
        <th><span class="dot" style = "background-color:#FFC300;" id = "4-a">a</span></th>
        <th><span class="dot" id = "4-b">b</span></th>
        <th><span class="dot" id = "4-c">c</span></th>
      </tr>
    </table>
  </div>

  <div id = "level-5">
    <div class = "arrow-container" style="margin-top: 60px;">
      <i id= "arrow-5-1" class="fas fa-arrow-up arrow" style="margin-left:auto; margin-right:40px; transform: rotate(0deg);"></i>
      <i id= "arrow-5-2" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right:auto; transform: rotate(0deg);"></i>
    </div>
    <div class = "arrow-container">
      <i id= "arrow-5-3" class="fas fa-arrow-up arrow" style="margin-left:auto; margin-right: 40px; transform: rotate(0deg);"></i>
      <i id= "arrow-5-4" class="fas fa-arrow-up arrow" style="margin-left:40px; margin-right: auto; transform: rotate(180deg);"></i>
    </div>
    <table class = "dots">
      <tr>
        <th><span class="dot" style = "background-color:#FFC300;" id = "5-a">a</span></th>
        <th><span class="dot" id = "5-b">b</span></th>
      </tr>
    </table>
  </div>

  <div id = "level-6"></div>
  <div id = "level-7"></div>
  <div id = "level-8"></div>

  <div class="color-bar">
    <div class="color-bar-item" style="background-color: #CB0000;"></div>
    <div class="color-bar-item" style="background-color: #ED7700;"></div>
    <div class="color-bar-item" style="background-color: #FFC300;"></div>
  </div>
</body>

<script>

  var x = 0;
  var max = 0;
  var r = 0;
  var y = 0;
  var currentLevel = "menu";

  var arrowArray = [ ["level-1-button", ["arrow-1-1","arrow-1-2","arrow-1-3"]                                     ],
                     ["level-2-button", ["arrow-2-1","arrow-2-2","arrow-2-3","arrow-2-4"]                         ],
                     ["level-3-button", ["arrow-3-1","arrow-3-2","arrow-3-3","arrow-3-4","arrow-3-5","arrow-3-6"] ],
                     ["level-4-button", ["arrow-4-1","arrow-4-2","arrow-4-3","arrow-4-4","arrow-4-5","arrow-4-6"] ],
                     ["level-5-button", ["arrow-5-1","arrow-5-2","arrow-5-3","arrow-5-4"]                         ]
                   ];

  var allLevels = ["level-1-button","level-2-button","level-3-button","level-4-button","level-5-button","level-6-button","level-7-button","level-8-button"];

  getElement("level-1-button").addEventListener("click", function (){menuTransition("level-1-button")});
  getElement("level-2-button").addEventListener("click", function (){menuTransition("level-2-button")});
  getElement("level-3-button").addEventListener("click", function (){menuTransition("level-3-button")});
  getElement("level-4-button").addEventListener("click", function (){menuTransition("level-4-button")});
  getElement("level-5-button").addEventListener("click", function (){menuTransition("level-5-button")});
  window.addEventListener("resize", windowReSize);

  getElement("1-a").addEventListener("click", function (){flip(["arrow-1-1","arrow-1-2"])});
  getElement("1-b").addEventListener("click", function (){flip(["arrow-1-1","arrow-1-3"])});

  getElement("2-a").addEventListener("click", function (){flip(["arrow-2-1","arrow-2-3"])});
  getElement("2-b").addEventListener("click", function (){flip(["arrow-2-3","arrow-2-2"])});
  getElement("2-c").addEventListener("click", function (){flip(["arrow-2-2","arrow-2-4"])});

  getElement("3-a").addEventListener("click", function (){flip(["arrow-3-2","arrow-3-4"])});
  getElement("3-b").addEventListener("click", function (){flip(["arrow-3-1","arrow-3-3","arrow-3-5"])});
  getElement("3-c").addEventListener("click", function (){flip(["arrow-3-4","arrow-3-5","arrow-3-6"])});

  getElement("4-a").addEventListener("click", function (){clock(["arrow-4-1","arrow-4-2", "arrow-4-5", "arrow-4-4"])});

  getElement("5-a").addEventListener("click", function (){clock(["arrow-5-1","arrow-5-2", "arrow-5-4", "arrow-5-3"])});
  getElement("5-b").addEventListener("click", function (){flip(["arrow-5-1"])});

  var canvas = document.getElementById("my-canvas");
  var c = canvas.getContext("2d");
  windowReSize();

  function windowReSize(){
    console.log("change");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    for(const level of allLevels){
      getElement(level.substring(0,level.length-7)).style.width = window.innerWidth;
      getElement(level.substring(0,level.length-7)).style.height = window.innerHeight - document.getElementById("title").style.height + "px";
    }
  }

  function getElement(id){
    if(document.getElementById(id) != null){
      return document.getElementById(id);
    }
    else{
      console.log("getElement is null");
    }
  }

  function menuTransition(id){
    var element = document.getElementById(id)
    var position = element.getBoundingClientRect();
    var cx = position.left + element.clientWidth/2;
    var cy = position.top + element.clientWidth/2;

    x = cx;
    y = cy;
    r = element.clientWidth/2;
    max = maxRadius(element);
    animate();

    for (const a of allLevels) {
      if(a != id){
        document.getElementById(a).innerHTML="";
      }
    }
    currentLevel = id;
  }

  function animate(){
    // console.log(r);
      c.clearRect(0,0,window.innerWidth, window.innerHeight);

      if(r<max){
        requestAnimationFrame(animate);
      }
      if(r >= max){
        setUpLevel();
      }

      c.beginPath();
      c.arc(x,y,r,0,Math.PI*2,false);
      // c.arc(100,100,1000,0,Math.PI*2,false);
      c.fillStyle = "#FFFFFC";
      c.fill();
      r = r + 10;
  }

  function maxRadius(element){
    var position = element.getBoundingClientRect();
    var x = position.left + element.clientWidth/2; //NOT RIGHT THIS IS NOT CENTERED
    var y = position.top + element.clientWidth/2;
    var w = window.innerWidth;
    var h = window.innerHeight;

    var maxDistance = 0.0;

    if(Math.sqrt(x**2 + y**2) > maxDistance){
      maxDistance = Math.sqrt(x**2 + y**2);
    }
    if(Math.sqrt(x**2 + (h-y)**2) > maxDistance){
      maxDistance = Math.sqrt(x**2 + (h-y)**2);
      // console.log(x^2 + y^2);
    }
    if(Math.sqrt((w-x)**2 + y**2) > maxDistance){
      maxDistance = Math.sqrt((w-x)**2 + y**2);
    }
    if(Math.sqrt((w-x)**2 + (h-y)**2) > maxDistance){
      maxDistance = Math.sqrt((w-x)**2 + (h-y)**2);
    }

    return maxDistance;
  }

  function setUpLevel(){
    document.getElementById("menu").style.opacity = 0;
    setTimeout(function(){

      document.getElementById("menu").style.display = "none";
      document.body.style.backgroundColor = "white";
      document.getElementById("title").classList.toggle("level");
      // document.getElementById("title").style.color = "black";
      // document.getElementById("title").style.fontSize = "110px";
      // document.getElementById("title").style.lineHeight = "95px";

      for(const level of allLevels){
        if(currentLevel == level){
          getElement(level.substring(0,level.length-7)).style.display = "block";
          break;
        }
      }

      // if(currentLevel == "level-1-button"){
      //    document.getElementById("level-1").style.display = "block";
      //  }
      //  else if(currentLevel == "level-2-button"){
      //    document.getElementById("level-2").style.display = "block";
      //  }
      //  else if(currentLevel == "level-3-button"){
      //    document.getElementById("level-3").style.display = "block";
      //  }
      //  else if(currentLevel == "level-4-button"){
      //    document.getElementById("level-4").style.display = "block";
      //  }
      //  else{
      //  }

    }, 1500);

  }

  function isUp(element){
    var string = element.style.transform;
    string = string.substring(7,string.length-3);
    if (string % 180 == 0){
      return true;
    }
    return false;
  }

  // function placeArrows(){
  //   if(currentLevel == "level-1-button"){
  //     document.getElementById("level-1").style.display = "block";
  //
  //     // document.getElementById("level-1-1").style.left = window.innerWidth/2 + "px";
  //     // document.getElementById("level-1-1").style.top = 0 + "px";
  //     // console.log("hello");
  //     //
  //     // document.getElementById("level-1-2").style.left = 100 + "px";
  //     // document.getElementById("level-1-2").style.top = 100 + "px";
  //     //
  //     // document.getElementById("level-1-3").style.left = 300 + "px";
  //     // document.getElementById("level-1-3").style.top = 300 + "px";
  //     // console.log("hello3");
  //   }
  //   else if(currentLevel == "level-2-button"){
  //     document.getElementById("level-2").style.display = "block";
  //   }
  //   else if(currentLevel == "level-3-button"){
  //     document.getElementById("level-3").style.display = "block";
  //   }
  //   else if(currentLevel == "level-4-button"){
  //     document.getElementById("level-4").style.display = "block";
  //   }
  //   else{
  //   }
  // }

  function getRotateValue(id){
    return parseInt(getElement(id).style.transform.substring(7,getElement(id).style.transform.length-3),10);
  }

  function isComplete(){
    var arrowLevelArray = null;

    for(const a of arrowArray){
      // console.log(a[0]);
      if(a[0] == currentLevel){
        arrowLevelArray = a[1];
        break;
      }
    }

    for(const a of arrowLevelArray){
      if(getRotateValue(a) % 360 != 0){
        return false;
      }
    }

    // alert("you win");
    return true;
  }

  function arrowAnimation(id, direction){
    if(getElement(id).classList.contains("animateDown")){
      getElement(id).classList.remove("animateDown");
    }
    else if(getElement(id).classList.contains("animateUp")){
      getElement(id).classList.remove("animateUp")
    }

    console.log(getElement(id).classList);
    setTimeout(function(){
      if(direction == 0){
        getElement(id).classList.add("animateUp");
      }
      else{
        getElement(id).classList.add("animateDown");
      }
     }, 100);



  }

  function flip(idArray){
    for(const id of idArray){
      var element = getElement(id);
      let num = getRotateValue(id) + 180;
      element.style.transform = "rotate("+ num + "deg)";
    }
    isComplete();
  }

  function clock(idArray){
    var temp = getRotateValue(idArray[idArray.length - 1]) % 360;
    var i = 0;

    for(i = idArray.length - 1; i > 0; i--){
      if(getRotateValue(idArray[i - 1]) % 360 == getRotateValue(idArray[i]) % 360){
        arrowAnimation(idArray[i], getRotateValue(idArray[i]) % 360);
        continue;
      }
      else{
        let num = getRotateValue(idArray[i]) + 180;
        getElement(idArray[i]).style.transform = "rotate("+ num + "deg)";
      }
    }

    if(temp != (getRotateValue(idArray[0]) % 360)){
      let num = getRotateValue(idArray[0]) + 180;
      getElement(idArray[0]).style.transform = "rotate("+ num + "deg)";
    }
    else{
      arrowAnimation(idArray[i],getRotateValue(idArray[0]) % 360);
    }
  }

  function finishLevel(){

  }

  function backwardsMenuAnimation(){
    
  }

</script>

<!-- https://speckyboy.com/custom-hover-click-effects-css-javascript/ -->
